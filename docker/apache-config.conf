# Apache + Passenger Configuration for Docker
# Simplified to match Domainesia cPanel style
# In cPanel, many directives are auto-injected by the control panel

<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /var/www/student-space/public

    # Passenger Configuration (core directives only)
    PassengerEnabled On
    PassengerAppRoot /var/www/student-space
    PassengerPython /var/www/venv/bin/python3.12
    PassengerStartupFile passenger_wsgi.py
    PassengerAppEnv production

    # Passenger tuning (match shared hosting limits)
    PassengerMaxPoolSize 6
    PassengerMinInstances 1
    PassengerMaxRequests 1000

    # Static files
    Alias /static /var/www/student-space/staticfiles
    <Directory /var/www/student-space/staticfiles>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    # Media files
    Alias /media /var/www/student-space/media
    <Directory /var/www/student-space/media>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    # Public directory
    <Directory /var/www/student-space/public>
        Require all granted
        AllowOverride All
    </Directory>

    # Application directory
    <Directory /var/www/student-space>
        Require all granted
        AllowOverride All
    </Directory>

    # Logging
    ErrorLog /var/log/apache2/student-space-error.log
    CustomLog /var/log/apache2/student-space-access.log combined
    PassengerLogLevel 3
</VirtualHost>
